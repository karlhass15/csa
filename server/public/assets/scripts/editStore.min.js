/*! csa 2016-01-08 */
var retrievedInfo={},storeInfo={};$(document).ready(function(){populateFields(),$("#editStoreForm").submit(addStore)});var populateFields=function(){retrievedInfo=localStorage.getItem("editInfo"),retrievedInfo=JSON.parse(retrievedInfo),console.log("This is the retrievedInfo: ",retrievedInfo),$(".storename").val(retrievedInfo.name),$(".address").val(retrievedInfo.address),$(".description").val(retrievedInfo.description),$(".website").val(retrievedInfo.website),$(".image").val(retrievedInfo.image);for(var a=0;a<retrievedInfo.categories.length;a++)$("input[value='"+retrievedInfo.categories[a].category+"']").prop("checked",!0)},addStore=function(){event.preventDefault(),storeInfo={};var a=[],b=new google.maps.Geocoder;$.each($(this).serializeArray(),function(a,b){storeInfo[b.name]=b.value});for(var c=$("input:checkbox:checked.group1").map(function(){return this.value}).get(),d=0;d<c.length;d++)a.push({category:c[d]});storeInfo.categories=a,storeInfo.id=retrievedInfo._id,b.geocode({address:storeInfo.address},function(a,b){if(b==google.maps.GeocoderStatus.OK){var c=a[0].geometry.location.lat(),d=a[0].geometry.location.lng(),e=[];e.push(c),e.push(d),storeInfo.latlong=e,changeStore()}else alert("Geocode was not successful for the following reason: "+b)})},changeStore=function(){$.ajax({type:"GET",url:"/getstoreforedit",data:{data:storeInfo},success:function(a){clearForm()}})},clearForm=function(){$("#editStoreForm").find("input[type=text]").val(""),$("#editStoreForm").find("textarea").val(""),$("#editStoreForm").find("input[type=checkbox]").removeAttr("checked"),localStorage.removeItem("editInfo"),window.location.replace("/assets/views/sct97ad33min.html")};