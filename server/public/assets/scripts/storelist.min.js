/*! csa 2016-01-08 */
function appDom(a){for(var b=0;b<a.length;b++){var c=(3963.2*a[b].distance).toFixed(1),d="https://www.google.com/maps/dir/Current+Location/",e=a[b].latlong[0],f=a[b].latlong[1],g=d+e+","+f;$("#storeList").append('<div class="container"><div class="col-xs-4"><img src=" '+a[b].image+' " /></div><div class="col-xs-8"><h1 class="action" data-list=" '+b+' ">'+a[b].name+"</h1><h2>"+c+' miles</h2><button><a href=" '+g+' ">Directions</button></div></div>')}}function displayLoading(){$("#spin").addClass("spinner")}function displayCompleted(){$("#spin").removeClass("spinner")}var myLatLng={},storesFound=[],storeContent=[];$(document).ready(function(){displayLoading(),getCurrentLocation(),$("body").on("click",".action",function(){localStorage.clear(),console.log("working"),console.log($(this).data("list"));var a=Number($(this).data("list"));console.log(storesFound),console.log(storesFound[a].name),localStorage.setItem("kittyFoo",JSON.stringify(storesFound[a])),window.location.href="store.html"})});var findStore=function(){console.log("The location data being sent to the db as search criteria: ",myLatLng),$.ajax({type:"GET",url:"/addStore",data:myLatLng,success:function(a){return console.log("The data response from the db: ",a),storesFound=a,appDom(storesFound),displayCompleted(),storesFound}})},getCurrentLocation=function(){function a(a,b,c){b.setPosition(c),b.setContent(a?"Error: The Geolocation service failed.":"Error: Your browser doesn't support geolocation.")}myLatLng={},navigator.geolocation?navigator.geolocation.getCurrentPosition(function(a){myLatLng.lat=parseFloat(a.coords.latitude),myLatLng.lng=parseFloat(a.coords.longitude),console.log("The variable LatLng: ",myLatLng),findStore()}):a(!1,infoWindow,map.getCenter())};